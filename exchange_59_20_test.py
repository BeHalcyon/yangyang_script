#!/bin/env python3
# -*- coding: utf-8 -*
'''
项目名称:exchange_59_20.py
Author: yangyang
功能：
Date: 2022-5-6
cron: 30 59 17 * * *
new Env("京东59减20测试版(python)");
'''

from exchange_lib import *

# 需要去http://waaq.cn/提取url

if 'API_59_20' in os.environ:
    total_url = os.environ['API_59_20']
else:
    total_url = r'http://api.m.jd.com/client.action?functionId=newReceiveRvcCoupon&clientVersion=10.0.0&build=88399&client=android&d_brand=SENSE&partner=yysd3&aid=57abbb727bf1d68f&oaid=bf3b5d6efffe0b6a&openudid=57abbb727bf1d68f&eid=eidA4433812365sfMqZFHKKGTleRxbeh8kr6YDKmRpnfP1peNlqtiWtizcsb1u3zC5kCt2xLMr1ANmRo5zMNNSpz/3DiPy9EwkMM+Ep9azjnUg0rFU1C&uts=0f31TVRjBSvHSHAVS7qYk7e0xxIRmnhXuTp9eIlES7ExAZAr%2BOC44YGIWprLB6ID1bmKqEO2cF1IlPahmpbZLFclzqNY0rix2hZ00nRhxyBEMMNBQY37qBANYP2jnKJg5wv%2BUwPNRwYuv9SSjSjcLWP3YIP8UXOsDnmhYaGVoAo8Y%2FD9Xrh2%2FNTR%2FG9WVaXLxKOaziQgvkAh%2Fydob5cqpQ%3D%3D&d_model=IDK-1001&osVersion=12&screen=2134*1080&lang=zh_CN&networkType=wifi&wifiBssid=unknown&uuid=57abbb727bf1d68f&sdkVersion=30&st=1651732005598&sign=42fb15522cdc37f197e129fc24c63adf&sv=120&body=%7B%22channel%22%3A%22%E9%A2%86%E5%88%B8%E4%B8%AD%E5%BF%83%22%2C%22childActivityUrl%22%3A%22openapp.jdmobile%3A%2F%2Fvirtual%3Fparams%3D%7B%5C%22category%5C%22%3A%5C%22jump%5C%22%2C%5C%22des%5C%22%3A%5C%22couponCenter%5C%22%7D%22%2C%22couponSource%22%3A%22manual%22%2C%22couponSourceDetail%22%3A%22null%22%2C%22eid%22%3A%22eidA4433812365sfMqZFHKKGTleRxbeh8kr6YDKmRpnfP1peNlqtiWtizcsb1u3zC5kCt2xLMr1ANmRo5zMNNSpz%2F3DiPy9EwkMM%2BEp9azjnUg0rFU1C%22%2C%22extend%22%3A%2288DB80104521161CDFFBD5A8057E28D33A51219BB81DCE6722CA735217442980A213BE06482C2B115ACD30536499B3CB0A01A2E3517769E5B0D9D7A5FEB8B8892408733446962758A6118E20FC69EEA2151C8384F6BBD8C70A8F1DEB3B5A37F177C71A7286A155BB2A6FED4D47F90C2E8E08E2BCBD94F7954B2C3EF96C2246A05C4560B336B0522C122D4360FCDE797D2D65C68AE0E33E3D3C69DF2B3356C69BA5930ADA99979A329A1A01F97BED9F171C27308F4A99B8DA51BDF775AE235F0DBCAF2DB5BCDA2D3F5D84D87B62F3A3289CA19FCDA4728263768BEECCD8FF46F69A7825DCBDB16A24AC1879DF42AAB3B7965FA90A776DCE659C79CAD8C4C7A39B200A1E50775F6B08ED893101832B830B9C3DFA799D890B51A45A8BC4C3538C63%22%2C%22lat%22%3A%22987254ce9da4b072b1cdec69d7592d8f%22%2C%22lng%22%3A%22175ffb892d025f8134406ec693606d98%22%2C%22pageClickKey%22%3A%22Coupons_GetCenter%22%2C%22rcType%22%3A%221%22%2C%22shshshfpb%22%3A%22JD012145b9HWZy9IjJZh163741402712206jW2WWPPx4EP0D1MjWqiCz3pFa7vXawF75Wjp097Qbsg0ahqr04%7EwyFt%2BkE58874zXw0xWdsbshHBJXLifkNFDnNh6HtytO0PmjIjkmqn7ZyNnvV24sDw8xbeF3pG%2Bnmne5XVvjOSgg%3D%3D%22%2C%22source%22%3A%22couponCenter_app%22%2C%22subChannel%22%3A%22%E9%99%90%E6%97%B6%E6%8A%A2%E5%88%B8%22%7D'

url = total_url.split('&body')[0]
body = 'body' + total_url.split('&body')[-1]

exchangeCoupons(url=url, body=body, batch_size=4, waiting_delta=0.1)